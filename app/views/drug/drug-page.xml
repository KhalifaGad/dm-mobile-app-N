<Page 
    id="drug-page"
    actionBarHidden="{{ actionBarStatus.hidden }}"
    xmlns="http://schemas.nativescript.org/tns.xsd"
    xmlns:lv="nativescript-ui-listview"
	xmlns:actionBar="components/actionBar" 
	xmlns:bottomNav="components/bottomNav" navigatingTo="onNavigatingTo" class="page">
	<Page.actionBar>
		<actionBar:ActionBar-component />
	</Page.actionBar>

	<AbsoluteLayout id="secondChild">
		<Label top="30" left="24" class="bold app-headers" textWrap="true" text="{{ navContext.drug.name }}" />
        <StackLayout top="100" left="24" class="item-headers-wrapper">
            <StackLayout orientation="horizontal" class="first-layer">
                <StackLayout orientation="vertical" horizontalAlignment="left" class="item-info-wrapper">
                    <StackLayout orientation="horizontal">
                        <Label text="Seller: " textWrap="true" />
                        <Label text="{{navContext.drug.seller}}" textWrap="true" class="bold" />
                    </StackLayout>
                    <StackLayout orientation="horizontal">
                        <Label text="Price: " textWrap="true" />
                        <Label text="{{navContext.drug.price + ' EGP'}}" textWrap="true" class="bold" />
                    </StackLayout>
                </StackLayout>
                <StackLayout class="header-discount-wrapper">
                    <Label horizontalAlignment="center" text="{{'- ' + navContext.drug.discount + '%'}}" />
                </StackLayout>
            </StackLayout>
            <StackLayout orientation="horizontal" class="second-layer" >
                <StackLayout orientation="horizontal" verticalAlignment="center" horizontalAlignment="left">
                    <Button text="Add To Cart" tap="showCartOptions" class="add-2-cart-btn" />
                </StackLayout>
                <StackLayout orientation="horizontal" verticalAlignment="center" horizontalAlignment="right" class="deffered-state" >
                    <Label text="Deffered" textWrap="true" verticalAlignment="bottom" class="white bold" />
                    <StackLayout class="switch-wrapper" >
                        <Switch isEnabled="false" checked="{{navContext.drug.deferred}}" class="switch" width="45vw" />
                    </StackLayout>
                </StackLayout>
            </StackLayout>
        </StackLayout>
        <StackLayout id="items-container" top="280" left="0" orientation="vertical" class="home-items-stklayout">
            <ActivityIndicator 
                horizontalAlignment="center"
                marginTop="139"
                visibility="{{viewModel.activityIndicatorVis}}"
                id="myIndicator"
                busy="{{ viewModel.notFetched }}"
                backgroundColor="transparent"
                color="#FF3838"
                width="100"
                height="100" />
            <ScrollView height="285" visibility="{{ viewModel.itemsViewVisibility }}" id="itemsScrollView"  scrollBarIndicatorVisible="false">
                <StackLayout height="285" id="itemsStackLayout" >
                    <ListView id="itemsListView" height="285" items="{{ viewModel.items }}">
                        <ListView.itemTemplate>
                            <StackLayout orientation="horizontal" class="list-item" val="{{ $value }}">
                            <StackLayout orientation="horizontal" class="drug-info-wrapper">
                                <StackLayout orientation="vertical" horizontalAlignment="right" verticalAlignment="middle" class="drug-name-price">
                                    <Label text="{{ $value.name }}" horizontalAlignment="left" class="drug-name" textWrap="true" />
                                    <Label text="{{'Price per pack ' + $value.price + 'EGP' }}" horizontalAlignment="left" textWrap="true" />
                                </StackLayout>
                                <StackLayout class="discount-box" orientation="vertical" horizontalAlignment="right">
                                    <Label text="{{ '-' + $value.discount + '%' }}" horizontalAlignment="center" />
                                </StackLayout>
                            </StackLayout>
                            <Button text="" tap="toDrug" class="to-drug-btn" />
                        </StackLayout>
                        </ListView.itemTemplate>
                    </ListView>
                </StackLayout>
            </ScrollView>
        </StackLayout>
		<bottomNav:BottomNav-component top="579" left="0" />
	</AbsoluteLayout>
</Page>